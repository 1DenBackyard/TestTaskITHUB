# TestTaskITHUB
# Агрегация данных по месяцам с учётом первого числа

## Описание задачи
Задача заключается в получении суммы значений `count` для каждого месяца, исключая первое число. Первые числа месяцев выводятся отдельно в формате `dd.MM.yyyy`, а суммы — в формате `MM.yyyy`. Результаты должны быть отсортированы в хронологическом порядке, с приоритетом первого числа внутри месяца.

## Требования
1. Реализация на T-SQL.
2. Использование временной таблицы для входных данных.
3. Логическое завершение работы с временной таблицей (удаление после выполнения).
4. Прокомментированный код.
5. Сортировка результатов согласно примеру.

## Установка и запуск
1. Скопируйте код в файл с расширением `.sql`.
2. Выполните скрипт в **SQL Server Management Studio** или через расширение **SQL Server (mssql)** в VS Code.

## Пример данных
### Входные данные
| date       | count |
|------------|-------|
| 2022-05-04 | 5     |
| 2022-05-03 | 2     |
| 2022-07-02 | 6     |
| 2022-12-01 | 3     |
| ...        | ...   |

### Выходные данные
| date        | count |
|-------------|-------|
| 05.2022     | 7     |
| 07.2022     | 8     |
| 01.10.2022  | 1     |
| 10.2022     | 8     |
| 01.12.2022  | 3     |

## Структура кода
1. **Временная таблица `#temp_data`**:
   - Создается для хранения входных данных.
   - Удаляется перед запуском, если уже существует.
2. **CTE `FirstDays`**:
   - Выбирает строки, где день = 1.
   - Форматирует дату в `dd.MM.yyyy`.
3. **CTE `MonthlySums`**:
   - Суммирует `count` по месяцам, исключая первые числа.
   - Группирует данные через `DATEADD` и `DATEDIFF`.
4. **Объединение и сортировка**:
   - `UNION ALL` для объединения первых чисел и сумм.
   - Сортировка по `COALESCE(original_date, month_start)` и приоритету первого числа.

## Тестирование
- Проверьте, что выходные данные соответствуют примеру.
- Убедитесь, что временная таблица удаляется после выполнения (`DROP TABLE`).